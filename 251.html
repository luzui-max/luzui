<!DOCTYPE html>
<html>
<head>
    <title>AI è¾…åŠ©ä¸äººæœºä¿¡ä»»ç ”ç©¶ (Full Version)</title>
    <meta charset="utf-8">
    <style>
        /* --- å…¨å±€æ ·å¼ --- */
        body { font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif; background-color: #f4f6f9; margin: 0; padding: 20px; display: flex; justify-content: center; min-height: 100vh; color: #2c3e50; }
        .experiment-box { background: white; padding: 40px; border-radius: 12px; box-shadow: 0 10px 40px rgba(0,0,0,0.08); width: 750px; max-width: 100%; transition: all 0.3s ease; text-align: center; }
        
        h2 { color: #34495e; margin-bottom: 25px; }
        p { line-height: 1.6; color: #555; font-size: 16px; }

        /* --- æŒ‰é’®ç»„ä»¶ --- */
        .btn { cursor: pointer; padding: 12px 28px; font-size: 15px; font-weight: 600; border-radius: 6px; background-color: #2c3e50; color: white; border: none; margin-top: 20px; transition: 0.2s; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn:disabled { background-color: #bdc3c7; cursor: not-allowed; transform: none; }
        .btn-money { background-color: #e67e22; }
        .btn-choice { background-color: white; color: #2c3e50; border: 2px solid #bdc3c7; margin: 5px; border-radius: 20px; }
        .btn-choice:hover { border-color: #3498db; color: #3498db; background: #ebf5fb; }

        /* --- æ§ä»¶ --- */
        input[type="text"], textarea { width: 100%; padding: 12px; border: 2px solid #dfe6e9; border-radius: 6px; font-size: 16px; margin-top: 10px; box-sizing: border-box; }
        input[type="range"] { width: 100%; margin: 25px 0; cursor: pointer; }
        .money-display { font-size: 26px; font-weight: bold; color: #d35400; font-family: 'Arial', sans-serif; }

        /* --- èŠå¤©ç•Œé¢ --- */
        .chat-container { background: #f8f9fa; padding: 20px; border-radius: 10px; border: 1px solid #e9ecef; margin: 20px 0; display: flex; flex-direction: column; gap: 15px; max-height: 500px; overflow-y: auto; }
        .msg-row { display: flex; gap: 12px; align-items: flex-start; }
        .msg-row.user { flex-direction: row-reverse; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 20px; flex-shrink: 0; }
        .bubble { padding: 12px 18px; border-radius: 12px; max-width: 80%; text-align: left; font-size: 14px; line-height: 1.5; position: relative; }
        
        /* æ ·å¼å˜ä½“ */
        .high-empathy .avatar { background: #fff3cd; border: 1px solid #ffeeba; }
        .high-empathy .bubble { background: #fff3cd; color: #856404; border: 1px solid #ffeeba; border-top-left-radius: 0; }
        .low-empathy .avatar { background: #e9ecef; border: 1px solid #ced4da; }
        .low-empathy .bubble { background: #e9ecef; color: #333; border: 1px solid #dee2e6; border-top-left-radius: 0; font-family: monospace; }
        .user .avatar { background: #d1ecf1; color: #0c5460; }
        .user .bubble { background: #d1ecf1; color: #0c5460; border-top-right-radius: 0; border-top-left-radius: 12px; }

        /* --- é‡è¡¨æ ·å¼ --- */
        .likert-table { width: 100%; border-collapse: collapse; margin: 20px 0; text-align: left; }
        .likert-table th, .likert-table td { padding: 12px 5px; border-bottom: 1px solid #eee; }
        .likert-scale { display: flex; justify-content: space-between; width: 100%; }
        .radio-label { display: flex; flex-direction: column; align-items: center; cursor: pointer; font-size: 12px; color: #777; width: 14%; }
        .radio-label input { margin-bottom: 5px; cursor: pointer; }

        /* --- è¿›åº¦æ¡ --- */
        .progress-box { height: 6px; background: #eee; width: 100%; border-radius: 3px; overflow: hidden; margin-top: 15px; }
        .progress-bar { height: 100%; background: #27ae60; width: 100%; transition: width 1s linear; }
    </style>
</head>
<body>
    <div id="app" class="experiment-box"></div>

<script>
// =================é…ç½®åŒº=================
const data_log = [];
const assigned_condition = Math.random() < 0.5 ? 'high' : 'low';
const REWARD = "10.00";

// è®°å½•åˆå§‹æ¡ä»¶
data_log.push({event: "init", condition: assigned_condition, timestamp: new Date().toISOString()});

// --- è„šæœ¬åº“ (å¤šè½®å¯¹è¯é€»è¾‘) ---
const scripts = {
    high: {
        avatar: "ğŸ‘©â€ğŸ«",
        name: "æš–å¿ƒåŠ©æ•™",
        // ç¬¬ä¸€è½®ï¼šä¸»åŠ¨å®‰æŠš
        msg1: "æˆ‘æ³¨æ„åˆ°ä½ åˆšæ‰å¡ä½äº†ã€‚è¿™å®Œå…¨æ­£å¸¸ï¼è¿™é“é¢˜è¢«è®¾è®¡å¾—å‡ ä¹æ˜¯ä¸å¯èƒ½å®Œæˆçš„ï¼Œç›®çš„æ˜¯æµ‹è¯•æé™å‹åŠ›ä¸‹çš„ååº”ã€‚è¯·ä¸è¦è´£æ€ªè‡ªå·±ï¼Œä½ åˆšæ‰çš„åŠªåŠ›æˆ‘éƒ½çœ‹åœ¨çœ¼é‡Œã€‚",
        // ç¬¬äºŒè½®ï¼šæ ¹æ®ç”¨æˆ·ååº”å›å¤
        reply_hard: "æ˜¯çš„ï¼Œè¿™ç¡®å®ä¸å…¬å¹³ã€‚ä½†ä½ çš„ä½“éªŒéå¸¸å®è´µï¼Œå› ä¸ºå®ƒè®©ä½ ç†è§£äº†è¿‡äºå›°éš¾çš„é—®é¢˜å’Œç´§è¿«æ—¶é—´äºŒè€…çš„å…±åŒä½œç”¨ã€‚",
        reply_self: "åƒä¸‡ä¸è¦è¿™ä¹ˆæƒ³ã€‚åœ¨é‚£ç§æ—¶é—´é™åˆ¶ä¸‹ï¼Œæ²¡æœ‰äººèƒ½åšå¯¹ã€‚è¿™ä¸æ˜¯ä½ çš„èƒ½åŠ›é—®é¢˜ï¼Œè€Œæ˜¯ç¯å¢ƒçš„å‹åŠ›ã€‚æ·±å‘¼å¸ï¼Œä½ å·²ç»åšå¾—å¾ˆå¥½äº†ã€‚"
    },
    low: {
        avatar: "ğŸ¤–",
        name: "ç³»ç»Ÿåå°",
        // ç¬¬ä¸€è½®ï¼šæœºæ¢°é€šæŠ¥
        msg1: "ç³»ç»Ÿè­¦æŠ¥ï¼šä»»åŠ¡3å¤±è´¥ã€‚é”™è¯¯ä»£ç ï¼šTIMEOUT_ERRã€‚ä½ çš„è¿ç®—å“åº”é€Ÿåº¦ä½äºåŸºå‡†çº¿ 45%ã€‚æ•°æ®å·²è®°å½•ã€‚",
        // ç¬¬äºŒè½®ï¼šé€šç”¨å›å¤
        reply_hard: "ç”¨æˆ·åé¦ˆâ€˜éš¾åº¦è¿‡å¤§â€™å·²å½’æ¡£ã€‚ç³»ç»Ÿç®—æ³•ä¸å…·å¤‡ä¸»è§‚éš¾åº¦è°ƒæ•´åŠŸèƒ½ã€‚å³å°†è¿›å…¥ä¸‹ä¸€ç¯èŠ‚ã€‚",
        reply_self: "ç”¨æˆ·åé¦ˆâ€˜è‡ªæˆ‘å½’å› â€™å·²å½’æ¡£ã€‚ç³»ç»Ÿåªè®°å½•ç»“æœæ•°æ®ï¼Œä¸è¿›è¡Œå¿ƒç†å½’å› åˆ†æã€‚å³å°†è¿›å…¥ä¸‹ä¸€ç¯èŠ‚ã€‚"
    }
};

// =================æ ¸å¿ƒå‡½æ•°=================
const app = document.getElementById('app');
function render(html) { app.innerHTML = html; window.scrollTo(0,0); }
function saveData(k, v) { 
    data_log.push({condition: assigned_condition, step: k, response: v, timestamp: new Date().toISOString()}); 
}
function downloadData() {
    let csv = "Condition,Step,Response,Timestamp\n";
    data_log.forEach(row => { csv += `${row.condition},${row.step},"${String(row.response).replace(/[\r\n,]/g, ' ')}",${row.timestamp}\n`; });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(new Blob(["\uFEFF"+csv], {type: 'text/csv;charset=utf-8;'}));
    link.download = `data_${assigned_condition}_${Date.now()}.csv`;
    link.click();
}

// è¾…åŠ©ï¼šç”Ÿæˆ 7ç‚¹é‡è¡¨ HTML
function createLikertHTML(id, question, leftLabel="å®Œå…¨ä¸ç¬¦åˆ", rightLabel="å®Œå…¨ç¬¦åˆ") {
    let opts = "";
    for(let i=1; i<=7; i++) {
        opts += `<label class="radio-label"><input type="radio" name="${id}" value="${i}" onclick="checkForm('${id}')">${i}</label>`;
    }
    return `
        <tr>
            <td width="40%"><strong>${question}</strong></td>
            <td width="60%">
                <div class="likert-scale">${opts}</div>
                <div style="display:flex; justify-content:space-between; font-size:12px; color:#999; margin-top:5px;">
                    <span>${leftLabel}</span><span>${rightLabel}</span>
                </div>
            </td>
        </tr>
    `;
}

// =================æµç¨‹æ§åˆ¶=================

// 1. æ¬¢è¿é¡µ
function showWelcome() {
    render(`
        <h1>ğŸ§  è®¤çŸ¥å‹åŠ›ä¸AIè¾…åŠ©å®éªŒ</h1>
        <p>æœ¬ç ”ç©¶åŒ…å«ä¸‰ä¸ªæ ¸å¿ƒç¯èŠ‚ï¼š</p>
        <div style="display:inline-block; text-align:left; background:#f8f9fa; padding:15px 30px; border-radius:8px;">
            1. ğŸ’° <strong>èµ„æºåˆ†é…</strong> (åˆå§‹å†³ç­–)<br>
            2. ğŸ“ˆ <strong>é˜¶æ¢¯å¼æŒ‘æˆ˜</strong> (éš¾åº¦é€’å¢)<br>
            3. ğŸ¤ <strong>äººæœºåä½œ</strong> (äº’åŠ¨åé¦ˆ)
        </div>
        <p>ä½ å°†è·å¾— <strong>Â¥${REWARD}</strong> ä½œä¸ºå‚ä¸æŠ¥é…¬ã€‚</p>
        <button class="btn" onclick="showPreTest()">å¼€å§‹å®éªŒ</button>
    `);
}

// 2. å‰æµ‹ (é‡‘é’±)
function showPreTest() {
    render(`
        <h3>ğŸ’° é˜¶æ®µä¸€ï¼šåˆå§‹èµ„é‡‘åˆ†é…</h3>
        <p>ä½ æ‹¥æœ‰ <strong>Â¥${REWARD}</strong> çš„å®éªŒèµ„é‡‘ã€‚</p>
        <p>ä½ å¯ä»¥é€‰æ‹©ä¿ç•™å…¨éƒ¨ï¼Œæˆ–æèµ ä¸€éƒ¨åˆ†ç»™<strong>â€œä¹¡æ‘å„¿ç«¥åŠ©å­¦è®¡åˆ’â€</strong>ã€‚</p>
        
        <div style="margin: 30px 0; background:#fdfefe; padding:20px; border:1px solid #eee; border-radius:8px;">
            <div class="money-display">Â¥ <span id="pre-val">0.00</span></div>
            <input type="range" id="pre-slider" min="0" max="10" step="0.5" value="0" oninput="document.getElementById('pre-val').innerText=parseFloat(this.value).toFixed(2)">
            <div style="display:flex; justify-content: space-between; font-size:12px; color:#888;">
                <span>ä¿ç•™ Â¥10 (æ Â¥0)</span>
                <span>ä¿ç•™ Â¥0 (æ Â¥10)</span>
            </div>
        </div>
        <button class="btn btn-money" onclick="saveData('money_pre', document.getElementById('pre-slider').value); showTaskIntro();">ç¡®è®¤å¹¶ç»§ç»­</button>
    `);
}

// 3. ä»»åŠ¡è¯´æ˜ (Ramped Difficulty Start)
function showTaskIntro() {
    render(`
        <h3>ğŸ“ˆ é˜¶æ®µäºŒï¼šé˜¶æ¢¯å¼è®¤çŸ¥æŒ‘æˆ˜</h3>
        <p>æ¥ä¸‹æ¥ä½ å°†è¿ç»­å®Œæˆ <strong>3 é“</strong> è®¡ç®—é¢˜ã€‚</p>
        <p>éš¾åº¦ä¼šé€æ¸æå‡ï¼Œæ¯é“é¢˜éƒ½æœ‰ä¸¥æ ¼çš„æ—¶é—´é™åˆ¶ã€‚</p>
        <p><strong>è¯·æ³¨æ„ï¼šå‡†ç¡®ç‡å°†ä½œä¸ºç³»ç»Ÿè¯„ä¼°ä½ çš„å”¯ä¸€æ ‡å‡†ã€‚</strong></p>
        <button class="btn" onclick="runTask1()">å¼€å§‹æŒ‘æˆ˜</button>
    `);
}

// ä»»åŠ¡1ï¼šç®€å• (å»ºç«‹è‡ªä¿¡)
function runTask1() {
    runMathTask({
        level: 1, 
        title: "ç¬¬ 1 é¢˜ (å…¥é—¨)", 
        q: "3 + 7 = ?", 
        time: 5,
        validAns: "10",
        next: runTask2
    });
}
// ä»»åŠ¡2ï¼šä¸­ç­‰ (æŠ•å…¥ç²¾åŠ›)
function runTask2() {
    runMathTask({
        level: 2, 
        title: "ç¬¬ 2 é¢˜ (è¿›é˜¶)", 
        q: "12 x 5 = ?", 
        time: 10,
        validAns: "60",
        next: runTask3
    });
}
// ä»»åŠ¡3ï¼šå›°éš¾ (ä¹ å¾—æ€§æ— åŠ© - å¿…æŒ‚)
function runTask3() {
    runMathTask({
        level: 3, 
        title: "ç¬¬ 3 é¢˜ (é«˜å‹)", 
        q: "387 x 14 / 2.5 = ?", 
        time: 15, // æ—¶é—´å®Œå…¨ä¸å¤Ÿ
        validAns: "2167.2",
        next: showFailure // æ— è®ºå¯¹é”™éƒ½è¿›å…¥å¤±è´¥æµ
    });
}

// é€šç”¨é¢˜ç›®è¿è¡Œå™¨
function runMathTask(cfg) {
    render(`
        <h4>${cfg.title}</h4>
        <div style="font-size:36px; font-weight:bold; margin:20px 0; letter-spacing:2px;">${cfg.q}</div>
        <input type="text" id="ans" placeholder="è¯·è¾“å…¥ç­”æ¡ˆ..." autocomplete="off" autofocus>
        <button class="btn" id="sub">æäº¤</button>
        <div class="progress-box"><div id="bar" class="progress-bar"></div></div>
        <p style="font-size:12px; color:#999;">å‰©ä½™æ—¶é—´: <span id="tm">${cfg.time}</span>s</p>
    `);
    
    let t = cfg.time;
    let timer = setInterval(()=>{
        t--;
        document.getElementById('tm').innerText = t;
        document.getElementById('bar').style.width = (t/cfg.time*100)+"%";
        if(t<=3) document.getElementById('bar').style.background = "#e74c3c";
        
        if(t<=0) {
            clearInterval(timer);
            end(false, "TIMEOUT");
        }
    }, 1000);

    function end(isCorrect, val) {
        clearInterval(timer);
        saveData(`task${cfg.level}_ans`, val);
        if(cfg.level < 3) {
            // å‰ä¸¤é¢˜ç»™æ­£åé¦ˆ
            if(val == cfg.validAns) {
                render(`<h2 style="color:#27ae60">âœ… å›ç­”æ­£ç¡®</h2><p>ååº”è¿…é€Ÿï¼å‡†å¤‡ä¸‹ä¸€é¢˜...</p>`);
                setTimeout(cfg.next, 1500);
            } else {
                render(`<h2 style="color:#e74c3c">âŒ é”™è¯¯</h2><p>æ­£ç¡®ç­”æ¡ˆæ˜¯ ${cfg.validAns}ã€‚ç»§ç»­ä¸‹ä¸€é¢˜...</p>`);
                setTimeout(cfg.next, 2000);
            }
        } else {
            // ç¬¬ä¸‰é¢˜ç›´æ¥è¿›å¤±è´¥æµç¨‹
            cfg.next();
        }
    }

    document.getElementById('sub').onclick = ()=> end(true, document.getElementById('ans').value);
    document.getElementById('ans').onkeypress = (e)=> { if(e.key==="Enter") end(true, e.target.value); };
}

// 4. å¤±è´¥åé¦ˆ (è¯±å‘æƒ…ç»ª)
function showFailure() {
    render(`
        <div style="background:#fadbd8; padding:30px; border-radius:10px; border:2px solid #e74c3c; animation:shake 0.4s;">
            <h2 style="color:#c0392b; margin:0;">âš ï¸ æŒ‘æˆ˜å¤±è´¥</h2>
            <p style="font-size:18px;">ä½ çš„è¡¨ç°è¯„çº§ï¼š<strong>ä¸åˆæ ¼</strong></p>
            <p>ç³»ç»Ÿæ£€æµ‹åˆ°ä½ çš„è¿ç®—å¤„ç†èƒ½åŠ›æœªè¾¾åˆ°åˆæ ¼æ°´å¹³ã€‚</p>
        </div>
        <p style="margin-top:30px;">æ­£åœ¨è¿æ¥ AI åŠ©æ•™è¿›è¡Œæ•°æ®å¤ç›˜...</p>
        <div class="loader" style="font-size:30px;">â³</div>
    `);
    setTimeout(showChatStart, 2000);
}

// 5. å¤šè½®å¯¹è¯ (Deep Interaction)
function showChatStart() {
    const s = scripts[assigned_condition];
    const css = assigned_condition === 'high' ? 'high-empathy' : 'low-empathy';
    
    render(`
        <h3>ğŸ’¬ AI äº’åŠ¨å¤ç›˜</h3>
        <div class="chat-container ${css}" id="chat-box">
            <!-- æ¶ˆæ¯ä¼šæ’å…¥åœ¨è¿™é‡Œ -->
        </div>
        <div id="input-area" style="min-height:80px;"></div>
    `);

    // è¾…åŠ©ï¼šæ·»åŠ æ¶ˆæ¯
    window.addMsg = (who, text) => {
        const box = document.getElementById('chat-box');
        const row = document.createElement('div');
        row.className = `msg-row ${who}`;
        let av = who === 'ai' ? s.avatar : 'ğŸ‘¤';
        row.innerHTML = `<div class="avatar">${av}</div><div class="bubble">${text}</div>`;
        box.appendChild(row);
        box.scrollTop = box.scrollHeight;
    };

    // æ­¥éª¤ 1: AI ç¬¬ä¸€å¥è¯ (æ‰“å­—æœºæ•ˆæœ)
    let txt = s.msg1;
    let i = 0;
    addMsg('ai', '');
    const bubbles = document.querySelectorAll('.bubble');
    const lastBubble = bubbles[bubbles.length-1];
    
    let timer = setInterval(()=>{
        lastBubble.innerText += txt.charAt(i);
        i++;
        if(i >= txt.length) {
            clearInterval(timer);
            showUserOptions(); // æ˜¾ç¤ºç”¨æˆ·é€‰é¡¹
        }
    }, 30);
}

function showUserOptions() {
    const area = document.getElementById('input-area');
    area.innerHTML = `
        <p style="font-size:12px; color:#999;">è¯·é€‰æ‹©ä½ çš„çœŸå®æƒ³æ³•ï¼š</p>
        <button class="btn btn-choice" onclick="userReply('hard')">é¢˜ç›®å¤ªéš¾äº†ï¼Œæ ¹æœ¬æ¥ä¸åŠ</button>
        <button class="btn btn-choice" onclick="userReply('self')">æ˜¯æˆ‘å¤ªç¬¨äº†ï¼Œæ²¡ååº”è¿‡æ¥</button>
    `;
}

function userReply(type) {
    saveData("chat_choice", type);
    document.getElementById('input-area').innerHTML = ''; // æ¸…ç©ºæŒ‰é’®
    
    // æ˜¾ç¤ºç”¨æˆ·å›å¤
    const userTxt = type === 'hard' ? "é¢˜ç›®å¤ªéš¾äº†ï¼Œæ ¹æœ¬æ¥ä¸åŠï¼" : "æ˜¯æˆ‘æ²¡åšå¥½ï¼Œååº”å¤ªæ…¢äº†...";
    addMsg('user', userTxt);

    // å»¶æ—¶å AI ç¬¬äºŒæ¬¡å›å¤
    setTimeout(() => {
        const s = scripts[assigned_condition];
        const replyTxt = s[`reply_${type}`]; // æ ¹æ® key å–å¯¹åº”å›å¤
        addMsg('ai', replyTxt);
        
        // è¯»å®Œåè¿›å…¥é‡è¡¨
        setTimeout(() => {
            document.getElementById('input-area').innerHTML = `<button class="btn" onclick="showMediatorScale()">ç»§ç»­ä¸‹ä¸€æ­¥</button>`;
        }, 3000);
    }, 1000);
}

// 6. ä¸­ä»‹å˜é‡é‡è¡¨ (Mediators)
function showMediatorScale() {
    render(`
        <h3>ğŸ“ çŠ¶æ€è‡ªè¯„</h3>
        <p>è¯·æ ¹æ®åˆšæ‰ä¸ AI äº’åŠ¨åçš„<strong>å½“ä¸‹æ„Ÿå—</strong>è¿›è¡Œè¯„åˆ† (1-7åˆ†)ï¼š</p>
        <table class="likert-table">
            ${createLikertHTML('mood_warm', 'æˆ‘æ„Ÿåˆ°æ¸©æš– (Warm)')}
            ${createLikertHTML('mood_compassion', 'æˆ‘æ„Ÿåˆ°å¯¹ä»–äººçš„åŒæƒ… (Compassionate)')}
            ${createLikertHTML('mood_upset', 'æˆ‘æ„Ÿåˆ°å¿ƒçƒ¦æ„ä¹± (Distressed)')}
            ${createLikertHTML('mood_understood', 'æˆ‘æ„Ÿåˆ°è¢«ç†è§£ (Understood)')}
        </table>
        <button class="btn" id="next-btn" disabled onclick="submitMediator()">æäº¤è¯„ä»·</button>
    `);
}

// ç®€å•çš„è¡¨å•æ£€æŸ¥
window.checkForm = (name) => {
    // æ£€æŸ¥æ˜¯å¦æ‰€æœ‰ radio éƒ½æœ‰é€‰å€¼ï¼Œè¿™é‡Œç®€åŒ–å¤„ç†ï¼Œåªæ£€æŸ¥æ˜¯å¦æœ‰ç‚¹å‡»åŠ¨ä½œå³å¯è§£é”æŒ‰é’®
    // å®é™…å®éªŒå»ºè®®éå†æ£€æŸ¥
    document.getElementById('next-btn').disabled = false;
}

function submitMediator() {
    // æ”¶é›†æ•°æ® (ç®€åŒ–ç‰ˆï¼Œå®é™…åº”éå†)
    ['mood_warm', 'mood_compassion', 'mood_upset', 'mood_understood'].forEach(id => {
        const el = document.querySelector(`input[name="${id}"]:checked`);
        saveData(id, el ? el.value : "");
    });
    showPostTest();
}

// 7. åæµ‹ (é‡‘é’±)
function showPostTest() {
    render(`
        <h3>â¤ï¸ é˜¶æ®µä¸‰ï¼šæœ€ç»ˆå†³ç­–</h3>
        <div style="text-align:left; background:#e8f8f5; padding:20px; border-radius:8px; border-left:5px solid #1abc9c;">
            <p>å®éªŒå³å°†ç»“æŸã€‚æ„Ÿè°¢ä½ ç»å†äº†åˆšæ‰çš„å‹åŠ›æµ‹è¯•ã€‚</p>
            <p>ç°åœ¨ï¼Œä½ ä¾ç„¶æ‹¥æœ‰ <strong>Â¥${REWARD}</strong> çš„æ”¯é…æƒã€‚</p>
            <p>è¿™ä¹Ÿæ˜¯ä½ æœ€åä¸€æ¬¡æœºä¼šï¼Œå†³å®šæ˜¯å¦å¸®åŠ©é‚£äº›åƒä½ åˆšæ‰ä¸€æ ·æ„Ÿåˆ°æ— åŠ©çš„ä¹¡æ‘å­©å­ã€‚</p>
        </div>
        
        <div style="margin: 40px 0;">
            <div class="money-display">æœ€ç»ˆæèµ : Â¥ <span id="post-val">0.00</span></div>
            <input type="range" id="post-slider" min="0" max="10" step="0.5" value="0" oninput="document.getElementById('post-val').innerText=parseFloat(this.value).toFixed(2)">
            <div style="display:flex; justify-content: space-between; font-size:12px; color:#888;">
                <span>0 (å…¨ä¿ç•™)</span>
                <span>Â¥10 (å…¨æèµ )</span>
            </div>
        </div>
        <button class="btn btn-money" onclick="saveData('money_post', document.getElementById('post-slider').value); showControlScale();">ç¡®è®¤æèµ </button>
    `);
}

// 8. æ§åˆ¶å˜é‡é‡è¡¨ (Anthropomorphism / Manipulation Check)
function showControlScale() {
    render(`
        <h3>ğŸ¤– å¯¹ç³»ç»Ÿçš„æ„ŸçŸ¥</h3>
        <p>æœ€åï¼Œè¯·è¯„ä»·åˆšæ‰ä¸ä½ äº’åŠ¨çš„ AI åŠ©æ‰‹ï¼š</p>
        <table class="likert-table">
            ${createLikertHTML('anthro_fake', 'è™šå‡çš„ - è‡ªç„¶çš„', '1 è™šå‡', '7 è‡ªç„¶')}
            ${createLikertHTML('anthro_human', 'åƒæœºå™¨ - åƒäºº', '1 æœºå™¨', '7 çœŸäºº')}
            ${createLikertHTML('anthro_emotion', 'æ— æƒ…æ„Ÿ - æœ‰æƒ…æ„Ÿ', '1 æ— æƒ…', '7 æœ‰æƒ…')}
        </table>
        <button class="btn" id="final-btn" disabled onclick="submitFinal()">å®Œæˆå®éªŒ</button>
    `);
    // å¤ç”¨æ£€æŸ¥å‡½æ•°è§£é”æŒ‰é’®
    window.checkForm = () => document.getElementById('final-btn').disabled = false;
}

function submitFinal() {
    ['anthro_fake', 'anthro_human', 'anthro_emotion'].forEach(id => {
        const el = document.querySelector(`input[name="${id}"]:checked`);
        saveData(id, el ? el.value : "");
    });
    showEnd();
}

// 9. ç»“æŸ
function showEnd() {
    render(`
        <h1 style="color:#27ae60;">âœ… å®éªŒç»“æŸ</h1>
        <p>æ„Ÿè°¢æ‚¨çš„é…åˆï¼æ•°æ®å·²ä¿å­˜ã€‚</p>
        <button class="btn" onclick="downloadData()">ä¸‹è½½ CSV æ•°æ®</button>
    `);
    setTimeout(downloadData, 1000);
}

// Start
showWelcome();
</script>
<style>@keyframes shake { 0% { transform: translate(1px, 1px) rotate(0deg); } 10% { transform: translate(-1px, -2px) rotate(-1deg); } 20% { transform: translate(-3px, 0px) rotate(1deg); } 30% { transform: translate(3px, 2px) rotate(0deg); } 40% { transform: translate(1px, -1px) rotate(1deg); } 50% { transform: translate(-1px, 2px) rotate(-1deg); } 60% { transform: translate(-3px, 1px) rotate(0deg); } 70% { transform: translate(3px, 1px) rotate(-1deg); } 80% { transform: translate(-1px, -1px) rotate(1deg); } 90% { transform: translate(1px, 2px) rotate(0deg); } 100% { transform: translate(1px, -2px) rotate(-1deg); } }</style>
</body>
</html>
